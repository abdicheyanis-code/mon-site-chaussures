<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS SNEAKERS - Official Store</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <style>
        /* --- CSS GLOBAL --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Orbitron', 'Segoe UI', sans-serif;
            background: #000; color: #fff; overflow-x: hidden; cursor: crosshair;
        }

        /* --- STYLES BOUTIQUE (EXISTANTS) --- */
        .particles { position: fixed; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .particle {
            position: absolute; width: 2px; height: 2px; background: #00ff88;
            border-radius: 50%; animation: float 8s infinite; box-shadow: 0 0 10px #00ff88;
        }
        @keyframes float { 0%, 100% { opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(-100vh); } }

        header {
            position: fixed; width: 100%; padding: 20px 50px; display: flex; justify-content: space-between;
            align-items: center; z-index: 1000; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            border-bottom: 2px solid #00ff88;
        }
        .logo { font-size: 28px; font-weight: bold; color: #00ff88; letter-spacing: 2px; }
        nav a { color: #00ff88; margin-left: 20px; text-decoration: none; font-weight: bold; cursor: pointer; }

        /* HERO & PRODUCTS */
        .hero { height: 80vh; display: flex; align-items: center; justify-content: center; text-align: center; z-index: 2; position: relative; }
        .hero h1 { font-size: 60px; color: transparent; -webkit-text-stroke: 2px #00ff88; margin-bottom: 20px; }
        
        .products { padding: 50px; z-index: 2; position: relative; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px; }
        .product-card {
            background: rgba(20,20,20,0.8); border: 1px solid #333; padding: 20px; border-radius: 15px;
            text-align: center; transition: 0.3s; position: relative; overflow: hidden;
        }
        .product-card:hover { border-color: #00ff88; transform: translateY(-10px); }
        .product-card img { width: 100%; height: 200px; object-fit: contain; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5)); }
        
        .price { font-size: 24px; color: #00d4ff; margin: 15px 0; font-weight: bold; }
        .buy-button { width: 100%; padding: 10px; background: #00ff88; border: none; font-weight: bold; cursor: pointer; }

        /* --- ADMIN PANEL (CACH√â PAR D√âFAUT) --- */
        #admin-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 20000; padding: 50px; overflow-y: auto;
        }
        #admin-overlay.active { display: block; }
        
        .admin-header { display: flex; justify-content: space-between; border-bottom: 2px solid #ff0055; padding-bottom: 20px; margin-bottom: 30px; }
        .admin-title { color: #ff0055; font-size: 30px; }
        .close-admin { background: transparent; color: #fff; font-size: 20px; border: 1px solid #fff; padding: 5px 15px; cursor: pointer; }

        .admin-section { background: #111; padding: 20px; margin-bottom: 20px; border: 1px solid #333; }
        .admin-section h3 { color: #aaa; margin-bottom: 15px; }
        
        .admin-input { width: 100%; padding: 12px; background: #222; border: 1px solid #444; color: #fff; margin-bottom: 10px; }
        .admin-btn { width: 100%; padding: 15px; background: #ff0055; color: #fff; border: none; font-weight: bold; cursor: pointer; }
        
        /* LOGIN MODAL */
        #login-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 30000; align-items: center; justify-content: center;
        }
        #login-modal.flex { display: flex; }

        /* PANIER & MODAL DZ (Copier du code pr√©c√©dent) */
        .cart-sidebar { position: fixed; top: 0; right: -400px; width: 350px; height: 100%; background: #111; z-index: 5000; transition: 0.3s; padding: 20px; border-left: 1px solid #00ff88; }
        .cart-sidebar.active { right: 0; }
        .order-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); background: #111; padding: 30px; border: 2px solid #00ff88; z-index: 6000; width: 90%; max-width: 400px; }
        .order-modal.active { display: block; }

        /* Footer */
        footer { padding: 40px; text-align: center; border-top: 1px solid #333; margin-top: 50px; position: relative; z-index: 2;}
        .secret-admin-link { color: #111; cursor: pointer; font-size: 12px; } /* Quasi invisible */
        .secret-admin-link:hover { color: #ff0055; }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <!-- HEADER -->
    <header>
        <div class="logo">NEXUS</div>
        <nav>
            <a onclick="toggleCart()">PANIER (<span id="cart-count">0</span>)</a>
        </nav>
    </header>

    <!-- HERO -->
    <section class="hero">
        <div>
            <h1>FUTURE FOOTWEAR</h1>
            <p>La r√©f√©rence Sneaker en Alg√©rie üá©üáø</p>
        </div>
    </section>

    <!-- BOUTIQUE -->
    <section class="products">
        <div class="product-grid" id="product-grid">
            <!-- LES PRODUITS S'AFFICHERONT ICI -->
            <p style="text-align:center; width:100%;">Chargement du stock...</p>
        </div>
    </section>

    <!-- FOOTER -->
    <footer>
        <p>¬© 2024 NEXUS DZ</p>
        <!-- LE BOUTON SECRET POUR L'ADMIN EST ICI (Le petit cadenas) -->
        <span class="secret-admin-link" onclick="openLogin()">üîí Admin Access</span>
    </footer>

    <!-- ================== ESPACE ADMIN CACH√â ================== -->
    
    <!-- 1. LOGIN -->
    <div id="login-modal">
        <div style="text-align:center;">
            <h2 style="color:#ff0055; margin-bottom:20px;">S√âCURIT√â NEXUS</h2>
            <input type="password" id="admin-pass" placeholder="Mot de passe" class="admin-input" style="text-align:center;">
            <button class="admin-btn" onclick="checkLogin()">D√âVERROUILLER</button>
            <button style="background:none; border:none; color:#aaa; margin-top:10px; cursor:pointer;" onclick="closeLogin()">Annuler</button>
        </div>
    </div>

    <!-- 2. DASHBOARD -->
    <div id="admin-overlay">
        <div class="admin-header">
            <div class="admin-title">üõ†Ô∏è DASHBOARD VENDEUR</div>
            <button class="close-admin" onclick="closeAdmin()">RETOUR AU SITE</button>
        </div>

        <div class="admin-section">
            <h3>üöö PRIX DE LIVRAISON (DA)</h3>
            <div style="display:flex; gap:10px;">
                <input type="number" id="adm-ship-home" placeholder="Domicile" class="admin-input">
                <input type="number" id="adm-ship-desk" placeholder="Bureau" class="admin-input">
            </div>
            <button class="admin-btn" style="background:#00d4ff; color:#000;" onclick="saveConfig()">ENREGISTRER PRIX</button>
        </div>

        <div class="admin-section">
            <h3>üëü AJOUTER UN PRODUIT</h3>
            <input type="text" id="adm-name" placeholder="Nom du mod√®le" class="admin-input">
            <input type="text" id="adm-desc" placeholder="Description courte" class="admin-input">
            <input type="number" id="adm-price" placeholder="Prix (DA)" class="admin-input">
            <input type="text" id="adm-img" placeholder="Lien Image (URL)" class="admin-input">
            <select id="adm-effect" class="admin-input">
                <option value="">Effet: Aucun</option>
                <option value="fire">Effet: Feu</option>
                <option value="thruster">Effet: Propulseur</option>
            </select>
            <button class="admin-btn" onclick="addProduct()">PUBLIER L'ARTICLE</button>
        </div>

        <div class="admin-section">
            <h3>üì¶ GESTION STOCK</h3>
            <div id="admin-list" style="color:#fff;"></div>
        </div>
    </div>

    <!-- ================== PANIER & COMMANDE ================== -->
    <div class="cart-sidebar" id="cart-sidebar">
        <h2 style="color:#00ff88; border-bottom:1px solid #333; padding-bottom:10px;">PANIER</h2>
        <div id="cart-items" style="height: 70%; overflow-y:auto; margin:20px 0;"></div>
        <div style="border-top:1px solid #333; padding-top:20px;">
            <div style="display:flex; justify-content:space-between; font-size:20px; font-weight:bold;">
                <span>Total:</span> <span id="cart-total">0 DA</span>
            </div>
            <button class="buy-button" onclick="openOrder()">COMMANDER</button>
            <button onclick="toggleCart()" style="width:100%; background:#333; border:none; color:#fff; padding:10px; margin-top:10px; cursor:pointer;">FERMER</button>
        </div>
    </div>

    <div class="order-modal" id="order-modal">
        <h2 style="color:#00ff88; text-align:center; margin-bottom:20px;">LIVRAISON</h2>
        <input type="text" id="dz-name" placeholder="Nom complet" class="admin-input">
        <input type="tel" id="dz-phone" placeholder="T√©l√©phone" class="admin-input">
        <select id="dz-delivery" class="admin-input" onchange="calcTotal()">
            <option value="0">-- Chargement Tarifs --</option>
        </select>
        <input type="text" id="dz-addr" placeholder="Adresse (Wilaya, Commune...)" class="admin-input">
        
        <div style="background:#222; padding:10px; margin:10px 0; border:1px dashed #00ff88;">
            <div>Articles: <span id="sum-items">0</span> DA</div>
            <div>Livraison: <span id="sum-ship">0</span> DA</div>
            <div style="font-weight:bold; color:#00ff88; font-size:18px; margin-top:5px;">TOTAL: <span id="sum-total">0</span> DA</div>
        </div>

        <button class="buy-button" onclick="sendWhatsapp()">CONFIRMER SUR WHATSAPP üì±</button>
        <button onclick="document.getElementById('order-modal').classList.remove('active')" style="width:100%; background:none; border:none; color:#aaa; margin-top:10px; cursor:pointer;">Annuler</button>
    </div>

    <script>
        // ==========================================================
        // ‚ö†Ô∏è REMPLACE ICI AVEC TA CONFIGURATION FIREBASE ‚ö†Ô∏è
        // ==========================================================
        const firebaseConfig = {
            apiKey: "AIzaSy...",
            authDomain: "ton-projet.firebaseapp.com",
            projectId: "ton-projet",
            storageBucket: "ton-projet.appspot.com",
            messagingSenderId: "...",
            appId: "..."
        };
        // ==========================================================

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        let products = [];
        let deliveryConfig = { home: 800, desk: 400 };
        let cart = JSON.parse(localStorage.getItem('nexus-cart')) || [];

        // --- 1. INITIALISATION ---
        async function init() {
            // Charger Config Livraison
            try {
                const doc = await db.collection('config').doc('shipping').get();
                if(doc.exists) deliveryConfig = doc.data();
                else await db.collection('config').doc('shipping').set(deliveryConfig); // Cr√©e par d√©faut
                
                // Remplir les champs Admin
                document.getElementById('adm-ship-home').value = deliveryConfig.home;
                document.getElementById('adm-ship-desk').value = deliveryConfig.desk;
                
                // Remplir le select Commande
                const sel = document.getElementById('dz-delivery');
                sel.options.length = 0;
                sel.options[0] = new Option(`üè† Domicile (+${deliveryConfig.home} DA)`, deliveryConfig.home);
                sel.options[1] = new Option(`üè¢ Bureau/StopDesk (+${deliveryConfig.desk} DA)`, deliveryConfig.desk);
                
            } catch(e) { console.log("Init config error", e); }

            // Charger Produits
            db.collection('products').orderBy('date', 'desc').onSnapshot(snap => {
                products = [];
                const grid = document.getElementById('product-grid');
                const adminList = document.getElementById('admin-list');
                
                grid.innerHTML = "";
                adminList.innerHTML = "";

                snap.forEach(doc => {
                    let p = doc.data();
                    p.id = doc.id;
                    products.push(p);

                    // Affichage CLIENT
                    let fx = "";
                    if(p.effect === 'fire') fx = `<div style="position:absolute; bottom:0; width:100%; height:20px; background:orange; filter:blur(10px);"></div>`;
                    
                    grid.innerHTML += `
                        <div class="product-card">
                            <div style="position:relative; height:200px; display:flex; align-items:center; justify-content:center;">
                                <img src="${p.img}" style="position:relative; z-index:2;">
                                ${fx}
                            </div>
                            <h3>${p.name}</h3>
                            <div class="price">${p.price} DA</div>
                            <button class="buy-button" onclick="addToCart('${p.id}')">AJOUTER</button>
                        </div>
                    `;

                    // Affichage ADMIN (Liste simple)
                    adminList.innerHTML += `
                        <div style="display:flex; justify-content:space-between; background:#222; padding:10px; margin-bottom:5px; align-items:center;">
                            <img src="${p.img}" width="40">
                            <span>${p.name}</span>
                            <button style="background:red; color:white; border:none; padding:5px;" onclick="deleteProduct('${p.id}')">X</button>
                        </div>
                    `;
                });
                
                if(products.length === 0) grid.innerHTML = "<p>Aucun produit disponible.</p>";
            });
            
            updateCartUI();
        }
        init();

        // --- 2. FONCTIONS ADMIN ---
        function openLogin() { document.getElementById('login-modal').classList.add('flex'); }
        function closeLogin() { document.getElementById('login-modal').classList.remove('flex'); }
        
        function checkLogin() {
            const p = document.getElementById('admin-pass').value;
            if(p === "admin123") { // ‚ö†Ô∏è MOT DE PASSE ADMIN ICI
                closeLogin();
                document.getElementById('admin-overlay').classList.add('active');
            } else {
                alert("Acc√®s refus√©");
            }
        }
        function closeAdmin() { document.getElementById('admin-overlay').classList.remove('active'); }

        function saveConfig() {
            const home = Number(document.getElementById('adm-ship-home').value);
            const desk = Number(document.getElementById('adm-ship-desk').value);
            db.collection('config').doc('shipping').set({ home, desk }).then(() => alert("Tarifs mis √† jour !"));
        }

        function addProduct() {
            const name = document.getElementById('adm-name').value;
            const price = Number(document.getElementById('adm-price').value);
            const img = document.getElementById('adm-img').value;
            const effect = document.getElementById('adm-effect').value;
            
            if(!name || !price) return alert("Nom et Prix obligatoires");
            
            db.collection('products').add({
                name, price, img, effect,
                date: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                alert("Produit ajout√© !");
                // Reset inputs
                document.getElementById('adm-name').value = "";
                document.getElementById('adm-price').value = "";
            });
        }

        function deleteProduct(id) {
            if(confirm("Supprimer ce produit ?")) db.collection('products').doc(id).delete();
        }

        // --- 3. FONCTIONS CLIENT (Panier) ---
        function addToCart(id) {
            const p = products.find(x => x.id === id);
            cart.push(p);
            saveCart();
            alert("Ajout√© au panier !");
        }
        function saveCart() {
            localStorage.setItem('nexus-cart', JSON.stringify(cart));
            updateCartUI();
        }
        function updateCartUI() {
            document.getElementById('cart-count').innerText = cart.length;
            const list = document.getElementById('cart-items');
            list.innerHTML = "";
            let total = 0;
            cart.forEach((p, i) => {
                total += p.price;
                list.innerHTML += `
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px; border-bottom:1px solid #333; padding-bottom:5px;">
                        <span>${p.name}</span>
                        <div style="text-align:right;">
                            <div>${p.price} DA</div>
                            <small style="color:red; cursor:pointer;" onclick="cart.splice(${i},1); saveCart();">Retirer</small>
                        </div>
                    </div>
                `;
            });
            document.getElementById('cart-total').innerText = total + " DA";
        }
        function toggleCart() { document.getElementById('cart-sidebar').classList.toggle('active'); }

        // --- 4. COMMANDE ---
        function openOrder() {
            if(cart.length === 0) return alert("Panier vide");
            toggleCart();
            document.getElementById('order-modal').classList.add('active');
            calcTotal();
        }
        
        function calcTotal() {
            let sub = 0; cart.forEach(p => sub += p.price);
            let ship = Number(document.getElementById('dz-delivery').value);
            document.getElementById('sum-items').innerText = sub;
            document.getElementById('sum-ship').innerText = ship;
            document.getElementById('sum-total').innerText = sub + ship;
        }

        function sendWhatsapp() {
            const name = document.getElementById('dz-name').value;
            const phone = document.getElementById('dz-phone').value;
            const addr = document.getElementById('dz-addr').value;
            const shipPrice = Number(document.getElementById('dz-delivery').value);
            
            if(!name || !phone) return alert("Remplissez les infos !");

            let msg = `*NOUVELLE COMMANDE* üöÄ\nüë§ ${name}\nüì± ${phone}\nüìç ${addr}\n\n`;
            cart.forEach(p => msg += `üëü ${p.name} - ${p.price} DA\n`);
            
            let sub = 0; cart.forEach(p => sub += p.price);
            msg += `\nüì¶ Sous-total: ${sub} DA`;
            msg += `\nüöö Livraison: ${shipPrice} DA`;
            msg += `\nüí∞ *TOTAL: ${sub + shipPrice} DA*`;

            // ‚ö†Ô∏è TON NUM√âRO ICI
            window.open(`https://wa.me/213550000000?text=${encodeURIComponent(msg)}`, '_blank');
        }

        // --- PARTICULES ---
        const pc = document.getElementById('particles');
        for(let i=0; i<30; i++) {
            let d = document.createElement('div'); d.className='particle';
            d.style.left = Math.random()*100+'%'; d.style.animationDelay = Math.random()*5+'s';
            pc.appendChild(d);
        }
    </script>
</body>
</html>
